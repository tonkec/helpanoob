<% if user_signed_in? %>
  <div class="home-wrapper">
  <div class="home-orders">
    |Rating| |Answered | Unanswered | Newest | Oldest |
  </div>
  <% @posts.each do |p| %>
    <div class="main-col p-l-0 p-r-0 pagination-col">

      <p class="main-home-p">
        <%= link_to image_tag(p.user.avatar), profile_path, class: "question-user-photo" %>
        <%=link_to (truncate (p.description), length: 100), post_path(p), class: "home-question-link" %>
        <%= link_to like_post_path(p), class: "like", method: :put do %>
          <i class="fa fa-heart-o fa-question-star">
           <%= p.votes_for.size %>
        </i>
        <% end %>
        
      </p>

    </div><!-- pagination-col -->
  <% end %>
  </div><!-- home-wrapper -->
  <a href="" class="btn btn-green btn-load">
    <span class="btn-text">Load more</span>
    <%= image_tag("loading.gif", class: "btn-loader") %>
  </a>

<input type="text" class="form-control main-search" placeholder="Search for...">
<% else %>
<%= link_to "Sign in", sign_in_path %>
<% end %>

<script>
  $(function(){
    var p = $(".pagination-col p").slice(0, 7).show(); // select the first ten
    $(p).parent().show();
    $(".btn-load").click(function(e){ // click event for load more
        $(".btn-loader").show();
        $(".btn-text").hide();
        e.preventDefault();

        setTimeout(function(){
          var moreP = $(".pagination-col p:hidden").slice(0, 7).show(); 
          $(moreP).parent().show();
          $(".btn-loader").hide();
          $(".btn-text").show();
        }, 400)
        
        if($(".pagination-col p:hidden").length == 2){ 
            $(".btn-load").hide();
        }
    });
});
</script>